# ABTest方案

## 一、ABTest概述

**ABTest**是一项用来验证产品新功能效果的科学在线测试方法。以**数据驱动**为导线，实现灵活的**流量切分**，使得同一产品的不同版本能同时在线，通过记录和分析用户对不同的版本产生的行为数据，对比效果保证决策的科学性和准确性。

**流量的隔离：**让同一个用户在同一段时间只能参与一个实验，从而避免多个实验导致的影响。



ABTest验证内容：

* 产品UI
* 文案内容
* 页面布局
* 产品功能
* 推荐算法

ABTest应用场景：

* 广告着陆页
* Web/H5页面
* APP用户体验
* 媒体广告投放与管理
* 灰度发布：技术&算法迭代

## 二、架构设计

ABTest整个架构包含以下部分：

* **ABTest管理平台：**实验操作门户，提供创建、修改、关闭Test等，并提供报表查看
* **配置数据库：**使用配置数据，不局限于关系数据库，也可能有缓存数据库
* **分流服务：**根据实验配置数据，实验具体的分流逻辑，一般集成在业务平台或业务服务器
* **SDK：**提供通用的解析分流逻辑，一般集成与客户端，前端
* **数据采集：**分流结果日志，用户行为日志的实时采集
* **数据分析：**实时和离线数据分析，通过一定的数据分析算法做出科学决策

<figure><img src="../.gitbook/assets/image (5).png" alt=""><figcaption><p>ABTest通用架构设计</p></figcaption></figure>

## 三、核心能力

#### 实验能力

实验能力主要包括实验管理、指标定义、圈人定向、分流服务、灰度推全等。

* 一次ABTest生命周期：创建实验、功能和链路验证、正式运行、逐步放量、全量推送等五个阶段。
* 每个用户通过算法当定到对应的映射桶上

#### 分析能力

分析能力包括实时的分流 PV/UV 统计，T+1 的实验显著性报表以及多维分析和对比分析。

实验分流数据分为客户端分流埋点和服务端 ABTest SDK 分流日志两种。

* **实时计算链路**
* **离线计算链路**
* **即时分析链路**

## 四、移动端设计

ABTest SDK主要实现以下功能：

* 实验配置动态下发。SDK实现了针对场景标识+用户分流标识的一致性哈希算法，根据场景的实验流量配置，进行实验配置的动态分发。
* 上报ABTest请求日志、业务自定义日志以及监控日志
* 基于ABTest埋点规范生成前端埋点标识。SDK 生成包括abTraceId（请求唯一标识）和bcm（请求结果标识）等追踪标识，用以透传到前端埋点来追踪用户行为。







































